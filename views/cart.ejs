<%- include('header.ejs') %>


      <!-- cart + summary -->
      <section class="bg-light " style="margin-top: 130px;">
        <div class="container">
          <div class="row">
            <!-- cart -->       
            <div class="col-lg-9">
              <div class="card border shadow-0">
                <div class="m-4">
                  <h4 class="card-title mb-4">Your shopping cart</h4>
                  <% if (isEmptyCart) { %>
                    <p>No items in the cart.</p>
                <% } else { %> 
                  <% items.forEach(item=>{%>  
                  <div class="row gy-3 mb-4">
                    <div class="col-lg-5">
                      <div class="me-lg-5">
                        <div class="d-flex">
                          <img src="<%= item.productId.image[0] %>" class="border rounded me-3" style="width: 96px; height: 116px;" />
                          <div class="">
                            <a href="/product-page/<%=item.productId._id%>" class="nav-link"><%=item.productId.productName%></a>
                            <p class="text-muted"><%=item.productId.productCategory.categoryName%></p>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-2 col-sm-6 col-6 d-flex flex-row flex-lg-column flex-xl-row text-nowrap">
                      <div class="">
                        <div class="input-group mb-3 product-quantity" style="width: 125px; padding-right: 20px;">
                          
                          
                            <button class="btn btn-white border border-secondary px-1 minusButton" type="button" data-mdb-ripple-color="dark" <%= item.quantity === 1 ? 'disabled' : ''%>>
                              <i class="fas fa-minus"></i>
                            </button>
                            <input type="text" name="quantityValue" class="form-control text-center border border-secondary quantityInput" style="width: 50px;" value="<%=item.quantity%>" data-product-id="<%=item.productId._id%>" data-total-quantity="<%= item.productId.totalQuantity %>" />
                            <button class="btn btn-white border border-secondary px-1 plusButton" type="button" data-mdb-ripple-color="dark" <%= item.quantity === item.productId.totalQuantity ? 'disabled' : ''%>>
                              <i class="fas fa-plus"></i>
                            </button>
                          
                      </div>
                      
                      </div>
                      <div class="">
                        <% if (item.productId.totalQuantity > 0) { %>
                        <text class="h6 total-price" data-product-id="<%= item.productId._id %>" data-price="<%= item.productId.price %>">₹<%= item.productId.price * item.quantity %></text> <br />
                        <small class="text-muted text-nowrap">₹<%=item.productId.price%> / per item </small>
                        <% } else { %>
                          <span class="text-danger">Out of Stock</span>
                        <% } %>
                      </div>
                    </div>
                    <div class="col-lg col-sm-6 d-flex justify-content-sm-center justify-content-md-start justify-content-lg-center justify-content-xl-end mb-2">
                      <div class="float-md-end">
                        <a href="#!" class="btn btn-light border px-2 icon-hover-primary"><i class="fas fa-heart fa-lg px-1 text-secondary"></i></a>
                        <form action="/cart-item-remove/<%=item.productId._id%>" class="btn" method="post">
                        <button type="submit" class="btn btn-light border text-danger icon-hover-danger">
                          Remove
                        </button>
                      </form>
                        
                      </div>
                    </div>
                  </div>     
                  <% }); %>
                </div>
      
                
              </div>
            </div>
            <!-- cart -->
            <!-- summary -->
            <div class="col-lg-3">
              <div class="card mb-3 border shadow-0">
                <div class="card-body">
                  <form>
                    <div class="card shadow-0 border">
                        <div class="card-body">
                          <div class="d-flex justify-content-between">
                            
                          </div>
                          
                          <hr />
                          <div class="d-flex justify-content-between">
                            <p class="mb-2">Cart Summary:</p>
                            <p id="cart-summary" class="cart-summary mb-2 fw-bold">₹<%=totalPrice%></p>
                          </div>
                          
              
                          <div class="mt-3">
                            <a href="/checkOut" class="btn  w-100 shadow-0 mb-2" id="make-purchase-btn"> Make Purchase </a>
                            <a href="#" class="btn btn-light w-100 border mt-2"> Back to shop </a>
                          </div>
                          <% } %>
                        </div>
                      </div>
                    </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              
            <!-- summary -->
          </div>
        </div>
      </section>
      <!-- cart + summary -->
     
      
 <%- include('footer.ejs')%>